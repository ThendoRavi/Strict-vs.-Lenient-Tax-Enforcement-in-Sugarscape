Environment variables set:
  JAVA_TOOL_OPTIONS=-Djava.awt.headless=true -Xmx4g
  DISPLAY=
  MPLBACKEND=Agg
Starting DQN run at Thu Oct 16 11:02:19 AM SAST 2025
✅ Found NetLogo at: /home-mscluster/travhengani/NetLogo-6.4.0-64

Starting DQN run at Thu Oct 16 11:02:32 2025
🔗 Initializing NetLogo connection...
   Path: /home-mscluster/travhengani/NetLogo-6.4.0-64
   GUI mode: FORCED FALSE (headless)
   Java options: -Djava.awt.headless=true -Xmx4g
⚠️  Trying alternative connection method...
✅ Connected using basic parameters
📂 Loading NetLogo model: Sugarscape 2 Constant Growback.nlogo
✅ NetLogo model loaded successfully!
✅ Successfully initialized DQN simulation
   NetLogo path: /home-mscluster/travhengani/NetLogo-6.4.0-64
   GUI mode: True
============================================================
DEEP Q-NETWORK TAX COMPLIANCE SIMULATION
============================================================

[AI] Using TensorFlow version: 2.20.0
[ACTION] Action spaces:
   - Movement: UP, DOWN, LEFT, RIGHT
   - Tax compliance: Pay full, Pay partial, Evade
[PENALTY] Death penalty: Large negative reward for learning

Initializing DQN simulation...
🔗 Initializing NetLogo connection...
   Path: /home-mscluster/travhengani/NetLogo-6.4.0-64
   GUI mode: FORCED FALSE (headless)
   Java options: -Djava.awt.headless=true -Xmx4g
⚠️  Trying alternative connection method...
✅ Connected using basic parameters
📂 Loading NetLogo model: Sugarscape 2 Constant Growback.nlogo
✅ NetLogo model loaded successfully!

Testing Python-NetLogo connection...
🔄 Testing DQN-NetLogo connection...
🎯 Running setup...
✅ Setup complete!
👥 Population: 200 turtles
📊 Getting turtle states...
📋 Got states for 200 agents
🧠 Processed 200 states for neural network
🎯 Sample state shape: (10,)
🎯 Sample state values: [0.         0.         0.67346939]...
[ACTION] Generated 200 actions
🎮 Action distribution: {'UNKNOWN_141': 1, 'UNKNOWN_30': 1, 'UNKNOWN_187': 1, 'UNKNOWN_109': 1, 'UNKNOWN_159': 1, 'UNKNOWN_144': 1, 'UNKNOWN_139': 1, 'UNKNOWN_158': 1, 'UNKNOWN_82': 1, 'UNKNOWN_48': 1, 'UNKNOWN_47': 1, 'UNKNOWN_190': 1, 'UNKNOWN_106': 1, 'UNKNOWN_74': 1, 'UNKNOWN_98': 1, 'UNKNOWN_57': 1, 'UNKNOWN_72': 1, 'UNKNOWN_37': 1, 'UNKNOWN_169': 1, 'UNKNOWN_112': 1, 'UNKNOWN_164': 1, 'UNKNOWN_147': 1, 'UNKNOWN_150': 1, 'UNKNOWN_163': 1, 'UNKNOWN_154': 1, 'UNKNOWN_176': 1, 'UNKNOWN_26': 1, 'UNKNOWN_69': 1, 'UNKNOWN_107': 1, 'UNKNOWN_135': 1, 'UNKNOWN_81': 1, 'UNKNOWN_108': 1, 'UNKNOWN_178': 1, 'UNKNOWN_118': 1, 'UNKNOWN_113': 1, 'UNKNOWN_140': 1, 'UNKNOWN_65': 1, 'UNKNOWN_60': 1, 'UNKNOWN_32': 1, 'UNKNOWN_168': 1, 'UNKNOWN_136': 1, 'PAY_FULL': 1, 'UNKNOWN_143': 1, 'UNKNOWN_56': 1, 'UNKNOWN_130': 1, 'UNKNOWN_21': 1, 'UNKNOWN_192': 1, 'UNKNOWN_77': 1, 'UNKNOWN_89': 1, 'UNKNOWN_162': 1, 'UNKNOWN_42': 1, 'UNKNOWN_91': 1, 'UNKNOWN_41': 1, 'UNKNOWN_92': 1, 'UNKNOWN_71': 1, 'UNKNOWN_166': 1, 'UNKNOWN_101': 1, 'UNKNOWN_79': 1, 'UNKNOWN_19': 1, 'UNKNOWN_182': 1, 'UNKNOWN_188': 1, 'UNKNOWN_127': 1, 'UNKNOWN_175': 1, 'UNKNOWN_97': 1, 'UNKNOWN_195': 1, 'UNKNOWN_146': 1, 'UNKNOWN_197': 1, 'UNKNOWN_149': 1, 'CONSUME': 1, 'UNKNOWN_103': 1, 'UNKNOWN_22': 1, 'UNKNOWN_111': 1, 'UNKNOWN_177': 1, 'UNKNOWN_28': 1, 'UNKNOWN_148': 1, 'UNKNOWN_99': 1, 'UNKNOWN_132': 1, 'UNKNOWN_181': 1, 'UNKNOWN_100': 1, 'UNKNOWN_196': 1, 'UNKNOWN_133': 1, 'UNKNOWN_85': 1, 'UNKNOWN_96': 1, 'UNKNOWN_119': 1, 'UNKNOWN_180': 1, 'UNKNOWN_68': 1, 'UNKNOWN_61': 1, 'UNKNOWN_95': 1, 'UNKNOWN_157': 1, 'UNKNOWN_171': 1, 'UNKNOWN_52': 1, 'UNKNOWN_80': 1, 'UNKNOWN_131': 1, 'UNKNOWN_174': 1, 'UNKNOWN_76': 1, 'UNKNOWN_93': 1, 'UNKNOWN_67': 1, 'UNKNOWN_123': 1, 'UNKNOWN_44': 1, 'UNKNOWN_55': 1, 'UNKNOWN_18': 1, 'UNKNOWN_185': 1, 'UNKNOWN_145': 1, 'UNKNOWN_88': 1, 'UNKNOWN_20': 1, 'UNKNOWN_9': 1, 'UNKNOWN_40': 1, 'UNKNOWN_86': 1, 'UNKNOWN_120': 1, 'UNKNOWN_199': 1, 'UNKNOWN_14': 1, 'UNKNOWN_64': 1, 'UNKNOWN_116': 1, 'UNKNOWN_16': 1, 'UNKNOWN_66': 1, 'UNKNOWN_117': 1, 'UNKNOWN_122': 1, 'UNKNOWN_11': 1, 'PAY_PARTIAL': 1, 'UNKNOWN_29': 1, 'UNKNOWN_59': 1, 'UNKNOWN_115': 1, 'UNKNOWN_43': 1, 'UNKNOWN_13': 1, 'UNKNOWN_53': 1, 'UNKNOWN_114': 1, 'UNKNOWN_31': 1, 'UNKNOWN_45': 1, 'UNKNOWN_46': 1, 'UP': 1, 'UNKNOWN_173': 1, 'UNKNOWN_102': 1, 'UNKNOWN_198': 1, 'UNKNOWN_124': 1, 'UNKNOWN_151': 1, 'UNKNOWN_10': 1, 'UNKNOWN_58': 1, 'UNKNOWN_94': 1, 'UNKNOWN_90': 1, 'UNKNOWN_152': 1, 'UNKNOWN_87': 1, 'UNKNOWN_172': 1, 'UNKNOWN_189': 1, 'UNKNOWN_126': 1, 'DOWN': 1, 'UNKNOWN_128': 1, 'UNKNOWN_194': 1, 'UNKNOWN_125': 1, 'UNKNOWN_84': 1, 'UNKNOWN_23': 1, 'UNKNOWN_36': 1, 'UNKNOWN_17': 1, 'UNKNOWN_191': 1, 'UNKNOWN_156': 1, 'UNKNOWN_83': 1, 'NO_CONSUME': 1, 'UNKNOWN_15': 1, 'UNKNOWN_183': 1, 'UNKNOWN_51': 1, 'UNKNOWN_62': 1, 'UNKNOWN_170': 1, 'UNKNOWN_105': 1, 'UNKNOWN_104': 1, 'UNKNOWN_49': 1, 'UNKNOWN_73': 1, 'UNKNOWN_24': 1, 'UNKNOWN_186': 1, 'UNKNOWN_138': 1, 'UNKNOWN_35': 1, 'UNKNOWN_54': 1, 'UNKNOWN_142': 1, 'UNKNOWN_179': 1, 'RIGHT': 1, 'UNKNOWN_25': 1, 'UNKNOWN_184': 1, 'UNKNOWN_137': 1, 'UNKNOWN_155': 1, 'UNKNOWN_27': 1, 'UNKNOWN_33': 1, 'UNKNOWN_38': 1, 'UNKNOWN_78': 1, 'UNKNOWN_110': 1, 'UNKNOWN_63': 1, 'UNKNOWN_50': 1, 'UNKNOWN_39': 1, 'UNKNOWN_129': 1, 'LEFT': 1, 'UNKNOWN_134': 1, 'UNKNOWN_12': 1, 'UNKNOWN_161': 1, 'UNKNOWN_160': 1, 'UNKNOWN_193': 1, 'UNKNOWN_70': 1, 'UNKNOWN_34': 1, 'EVADE': 1, 'UNKNOWN_167': 1, 'UNKNOWN_165': 1, 'UNKNOWN_75': 1, 'UNKNOWN_153': 1, 'UNKNOWN_121': 1}

🎉 DQN CONNECTION TEST SUCCESSFUL! 🎉

============================================================

RUNNING TEST EXPERIMENT WITH DQN
----------------------------------------

🔬 Experiment 1/1: dqn_test_strict

🧠 Starting DQN experiment: dqn_test_strict
   Parameters: audit=0.3, mode=strict, duration=50
   Neural Network: 10 inputs -> 9 outputs
   🎮 Action Space: 0-3=Move, 4-5=Consume, 6-8=Tax(Pay/Partial/Evade)
   💀 Death penalty: -100, Tax penalties: -20 evade, -10 partial
   ⏰ Audit frequency: every 50 ticks

============================================================
📊 Episode 1/3 - Starting at 11:02:43
============================================================

🚀 Starting episode: 200 years, audit_rate=0.3, mode=strict, duration=50
  🔍 Year 0: AUDIT PERIOD - agents making tax decisions
    Actions: 90 move, 48 consume, 62 tax (took 0.107s)
    Rewards: total=0.0, deaths=0, punishment=0.0
  [DEBUG Year 0] Pop=200, Gini=0.225, Sugar=2647, Deaths=0

📊 Year 0 Summary:
    Population: 200 (deaths this year: 0)
    Economics: Gini=0.225, Total Sugar=2647
    Tax Behavior: Compliance=80.0%, Evasion=12.0%
    Learning: Epsilon=0.9950, Memory=200
    Rewards: Current=0.0, Average=0.00
    Actions so far: 90 move, 48 consume, 62 tax
    Rewards: total=-100.0, deaths=1, punishment=0.0
  [DEBUG Year 1] Pop=199, Gini=0.233, Sugar=2760, Deaths=1
    Rewards: total=-200.0, deaths=2, punishment=0.0
  [DEBUG Year 2] Pop=197, Gini=0.251, Sugar=2823, Deaths=2
    Rewards: total=-400.0, deaths=4, punishment=0.0
    Rewards: total=-400.0, deaths=4, punishment=0.0
    Rewards: total=-300.0, deaths=3, punishment=0.0
    Rewards: total=-300.0, deaths=3, punishment=0.0
    Rewards: total=-100.0, deaths=1, punishment=0.0
    Rewards: total=-700.0, deaths=7, punishment=0.0
    Rewards: total=-200.0, deaths=2, punishment=0.0
    Rewards: total=-400.0, deaths=4, punishment=0.0
  [DEBUG Year 10] Pop=169, Gini=0.316, Sugar=3746, Deaths=4
    Rewards: total=-100.0, deaths=1, punishment=0.0
    Rewards: total=-400.0, deaths=4, punishment=0.0
    Rewards: total=-200.0, deaths=2, punishment=0.0
    Rewards: total=-300.0, deaths=3, punishment=0.0
    Rewards: total=-200.0, deaths=2, punishment=0.0
    Rewards: total=-200.0, deaths=2, punishment=0.0
    Rewards: total=-100.0, deaths=1, punishment=0.0
    Rewards: total=-200.0, deaths=2, punishment=0.0
    Rewards: total=-100.0, deaths=1, punishment=0.0
  [DEBUG Year 20] Pop=151, Gini=0.332, Sugar=5218, Deaths=1
    Rewards: total=-100.0, deaths=1, punishment=0.0
    Rewards: total=-300.0, deaths=3, punishment=0.0
    Rewards: total=-100.0, deaths=1, punishment=0.0
  🏃 Year 25: Regular period - movement and consumption only
    Actions: 88 move, 58 consume, 0 tax (took 0.117s)
    Rewards: total=-100.0, deaths=1, punishment=0.0
    Rewards: total=-100.0, deaths=1, punishment=0.0
  [DEBUG Year 30] Pop=144, Gini=0.330, Sugar=6882, Deaths=0
    Rewards: total=-100.0, deaths=1, punishment=0.0
    Rewards: total=-100.0, deaths=1, punishment=0.0
    Rewards: total=-200.0, deaths=2, punishment=0.0
    Rewards: total=-100.0, deaths=1, punishment=0.0
    Rewards: total=-100.0, deaths=1, punishment=0.0
  [DEBUG Year 49] Pop=138, Gini=0.331, Sugar=10121, Deaths=0
  🔍 Year 50: AUDIT PERIOD - agents making tax decisions
    Actions: 49 move, 44 consume, 45 tax (took 0.102s)
    Rewards: total=0.0, deaths=0, punishment=0.0
    🧠 Training: memory=7941, epsilon=0.7744, added 138 experiences
  [DEBUG Year 50] Pop=138, Gini=0.323, Sugar=6546, Deaths=0

📊 Year 50 Summary:
    Population: 138 (deaths this year: 0)
    Economics: Gini=0.323, Total Sugar=6546
    Tax Behavior: Compliance=79.0%, Evasion=7.2%
    Learning: Epsilon=0.7744, Memory=7941
    Rewards: Current=0.0, Average=-121.57
    Actions so far: 4775 move, 3059 consume, 107 tax
  [DEBUG Year 51] Pop=138, Gini=0.325, Sugar=6729, Deaths=0
    Rewards: total=-100.0, deaths=1, punishment=0.0
    Rewards: total=-300.0, deaths=3, punishment=0.0
    Rewards: total=-100.0, deaths=1, punishment=0.0
    Rewards: total=-100.0, deaths=1, punishment=0.0
    Rewards: total=-100.0, deaths=1, punishment=0.0
  🏃 Year 75: Regular period - movement and consumption only
    Actions: 66 move, 65 consume, 0 tax (took 0.097s)
    Rewards: total=0.0, deaths=0, punishment=0.0
    Rewards: total=-100.0, deaths=1, punishment=0.0
  🔍 Year 100: AUDIT PERIOD - agents making tax decisions
    Actions: 39 move, 50 consume, 41 tax (took 0.097s)
    Rewards: total=-100.0, deaths=1, punishment=0.0
    🧠 Training: memory=10000, epsilon=0.6027, added 0 experiences
  [DEBUG Year 100] Pop=129, Gini=0.353, Sugar=8917, Deaths=1

📊 Year 100 Summary:
    Population: 129 (deaths this year: 1)
    Economics: Gini=0.353, Total Sugar=8917
    Tax Behavior: Compliance=86.8%, Evasion=9.3%
    Learning: Epsilon=0.6027, Memory=10000
    Rewards: Current=-100.0, Average=-70.30
    Actions so far: 8082 move, 6341 consume, 148 tax
    Rewards: total=-100.0, deaths=1, punishment=0.0
    Rewards: total=-100.0, deaths=1, punishment=0.0
    Rewards: total=-100.0, deaths=1, punishment=0.0
    Rewards: total=-100.0, deaths=1, punishment=0.0
  🏃 Year 125: Regular period - movement and consumption only
    Actions: 60 move, 65 consume, 0 tax (took 0.094s)
    Rewards: total=0.0, deaths=0, punishment=0.0
    Rewards: total=-100.0, deaths=1, punishment=0.0
    Rewards: total=-100.0, deaths=1, punishment=0.0
  🔍 Year 150: AUDIT PERIOD - agents making tax decisions
    Actions: 26 move, 19 consume, 78 tax (took 0.093s)
    Rewards: total=0.0, deaths=0, punishment=0.0
    🧠 Training: memory=10000, epsilon=0.4691, added 0 experiences

📊 Year 150 Summary:
    Population: 123 (deaths this year: 0)
    Economics: Gini=0.349, Total Sugar=10711
    Tax Behavior: Compliance=85.4%, Evasion=9.8%
    Learning: Epsilon=0.4691, Memory=10000
    Rewards: Current=0.0, Average=-50.99
    Actions so far: 11092 move, 9490 consume, 226 tax
    Rewards: total=-100.0, deaths=1, punishment=0.0
    Rewards: total=-100.0, deaths=1, punishment=0.0
    Rewards: total=-100.0, deaths=1, punishment=0.0
    Rewards: total=-100.0, deaths=1, punishment=0.0
  🏃 Year 175: Regular period - movement and consumption only
    Actions: 58 move, 61 consume, 0 tax (took 0.097s)
    Rewards: total=0.0, deaths=0, punishment=0.0
    Rewards: total=-100.0, deaths=1, punishment=0.0
    Rewards: total=-100.0, deaths=1, punishment=0.0

✅ Episode Complete!
    Total years: 200
    📊 Data points collected: 200 (tracking every year)
    Total deaths: 83
    Average reward per year: -41.50
    Final epsilon: 0.366958
    Final memory size: 10000

🎯 Episode 1 COMPLETE! (took 1.2 minutes)
    Final learning state:
      - Epsilon (exploration): 0.366958
      - Memory size: 10,000 experiences
      - Years completed: 200
      - Final population: 117
      - Final Gini coefficient: 0.315
      - Final compliance rate: 88.9%

============================================================
📊 Episode 2/3 - Starting at 11:03:56
============================================================

🚀 Starting episode: 200 years, audit_rate=0.3, mode=strict, duration=50
  🔍 Year 0: AUDIT PERIOD - agents making tax decisions
    Actions: 59 move, 32 consume, 109 tax (took 0.103s)
    Rewards: total=0.0, deaths=0, punishment=0.0
  [DEBUG Year 0] Pop=200, Gini=0.218, Sugar=2635, Deaths=0

📊 Year 0 Summary:
    Population: 200 (deaths this year: 0)
    Economics: Gini=0.218, Total Sugar=2635
    Tax Behavior: Compliance=92.5%, Evasion=2.0%
    Learning: Epsilon=0.3651, Memory=10000
    Rewards: Current=0.0, Average=0.00
    Actions so far: 59 move, 32 consume, 109 tax
    Rewards: total=-100.0, deaths=1, punishment=0.0
  [DEBUG Year 1] Pop=199, Gini=0.223, Sugar=2756, Deaths=1
    Rewards: total=-100.0, deaths=1, punishment=0.0
  [DEBUG Year 2] Pop=198, Gini=0.234, Sugar=2853, Deaths=1
    Rewards: total=-100.0, deaths=1, punishment=0.0
    Rewards: total=-200.0, deaths=2, punishment=0.0
    Rewards: total=-100.0, deaths=1, punishment=0.0
    Rewards: total=-200.0, deaths=2, punishment=0.0
    Rewards: total=-100.0, deaths=1, punishment=0.0
    Rewards: total=-300.0, deaths=3, punishment=0.0
    Rewards: total=-200.0, deaths=2, punishment=0.0
    Rewards: total=-200.0, deaths=2, punishment=0.0
  [DEBUG Year 10] Pop=184, Gini=0.336, Sugar=3748, Deaths=2
    Rewards: total=-500.0, deaths=5, punishment=0.0
    Rewards: total=-100.0, deaths=1, punishment=0.0
    Rewards: total=-500.0, deaths=5, punishment=0.0
    Rewards: total=-100.0, deaths=1, punishment=0.0
    Rewards: total=-300.0, deaths=3, punishment=0.0
    Rewards: total=-100.0, deaths=1, punishment=0.0
    Rewards: total=-100.0, deaths=1, punishment=0.0
    Rewards: total=-100.0, deaths=1, punishment=0.0
    Rewards: total=-300.0, deaths=3, punishment=0.0
  [DEBUG Year 20] Pop=163, Gini=0.361, Sugar=5122, Deaths=3
    Rewards: total=-300.0, deaths=3, punishment=0.0
    Rewards: total=-400.0, deaths=4, punishment=0.0
    Rewards: total=-300.0, deaths=3, punishment=0.0
    Rewards: total=-200.0, deaths=2, punishment=0.0
  🏃 Year 25: Regular period - movement and consumption only
    Actions: 97 move, 54 consume, 0 tax (took 0.120s)
    Rewards: total=-100.0, deaths=1, punishment=0.0
    Rewards: total=-100.0, deaths=1, punishment=0.0
    Rewards: total=-200.0, deaths=2, punishment=0.0
    Rewards: total=-100.0, deaths=1, punishment=0.0
    Rewards: total=-100.0, deaths=1, punishment=0.0
  [DEBUG Year 30] Pop=145, Gini=0.316, Sugar=6736, Deaths=0
    Rewards: total=-100.0, deaths=1, punishment=0.0
    Rewards: total=-100.0, deaths=1, punishment=0.0
    Rewards: total=-100.0, deaths=1, punishment=0.0
  [DEBUG Year 49] Pop=142, Gini=0.330, Sugar=9892, Deaths=0
  🔍 Year 50: AUDIT PERIOD - agents making tax decisions
    Actions: 29 move, 7 consume, 106 tax (took 0.115s)
    Rewards: total=0.0, deaths=0, punishment=0.0
    🧠 Training: memory=10000, epsilon=0.2842, added 0 experiences
  [DEBUG Year 50] Pop=142, Gini=0.326, Sugar=6420, Deaths=0

📊 Year 50 Summary:
    Population: 142 (deaths this year: 0)
    Economics: Gini=0.326, Total Sugar=6420
    Tax Behavior: Compliance=85.9%, Evasion=7.0%
    Learning: Epsilon=0.2842, Memory=10000
    Rewards: Current=0.0, Average=-113.73
    Actions so far: 5199 move, 2830 consume, 215 tax
  [DEBUG Year 51] Pop=142, Gini=0.327, Sugar=6624, Deaths=0
    Rewards: total=-100.0, deaths=1, punishment=0.0
    Rewards: total=-100.0, deaths=1, punishment=0.0
    Rewards: total=-100.0, deaths=1, punishment=0.0
    Rewards: total=-100.0, deaths=1, punishment=0.0
  🏃 Year 75: Regular period - movement and consumption only
    Actions: 108 move, 30 consume, 0 tax (took 0.100s)
    Rewards: total=0.0, deaths=0, punishment=0.0
    Rewards: total=-100.0, deaths=1, punishment=0.0
  🔍 Year 100: AUDIT PERIOD - agents making tax decisions
    Actions: 50 move, 8 consume, 79 tax (took 0.097s)
    Rewards: total=0.0, deaths=0, punishment=0.0
    🧠 Training: memory=10000, epsilon=0.2212, added 0 experiences
  [DEBUG Year 100] Pop=137, Gini=0.348, Sugar=9155, Deaths=0

📊 Year 100 Summary:
    Population: 137 (deaths this year: 0)
    Economics: Gini=0.348, Total Sugar=9155
    Tax Behavior: Compliance=93.4%, Evasion=4.4%
    Learning: Epsilon=0.2212, Memory=10000
    Rewards: Current=0.0, Average=-62.38
    Actions so far: 9998 move, 4879 consume, 294 tax
    Rewards: total=-100.0, deaths=1, punishment=0.0
    Rewards: total=-100.0, deaths=1, punishment=0.0
    Rewards: total=-100.0, deaths=1, punishment=0.0
  🏃 Year 125: Regular period - movement and consumption only
    Actions: 112 move, 22 consume, 0 tax (took 0.097s)
    Rewards: total=0.0, deaths=0, punishment=0.0
  🔍 Year 150: AUDIT PERIOD - agents making tax decisions
    Actions: 62 move, 6 consume, 66 tax (took 0.096s)
    Rewards: total=0.0, deaths=0, punishment=0.0
    🧠 Training: memory=10000, epsilon=0.1721, added 0 experiences

📊 Year 150 Summary:
    Population: 134 (deaths this year: 0)
    Economics: Gini=0.333, Total Sugar=10751
    Tax Behavior: Compliance=94.0%, Evasion=3.0%
    Learning: Epsilon=0.1721, Memory=10000
    Rewards: Current=0.0, Average=-43.71
    Actions so far: 15497 move, 6040 consume, 360 tax
    Rewards: total=-100.0, deaths=1, punishment=0.0
  🏃 Year 175: Regular period - movement and consumption only
    Actions: 122 move, 11 consume, 0 tax (took 0.138s)
    Rewards: total=0.0, deaths=0, punishment=0.0

✅ Episode Complete!
    Total years: 200
    📊 Data points collected: 200 (tracking every year)
    Total deaths: 67
    Average reward per year: -33.50
    Final epsilon: 0.134658
    Final memory size: 10000

🎯 Episode 2 COMPLETE! (took 1.2 minutes)
    Final learning state:
      - Epsilon (exploration): 0.134658
      - Memory size: 10,000 experiences
      - Years completed: 200
      - Final population: 133
      - Final Gini coefficient: 0.329
      - Final compliance rate: 94.7%

============================================================
📊 Episode 3/3 - Starting at 11:05:09
============================================================

🚀 Starting episode: 200 years, audit_rate=0.3, mode=strict, duration=50
  🔍 Year 0: AUDIT PERIOD - agents making tax decisions
    Actions: 96 move, 14 consume, 90 tax (took 0.124s)
    Rewards: total=0.0, deaths=0, punishment=0.0
  [DEBUG Year 0] Pop=200, Gini=0.219, Sugar=2701, Deaths=0

📊 Year 0 Summary:
    Population: 200 (deaths this year: 0)
    Economics: Gini=0.219, Total Sugar=2701
    Tax Behavior: Compliance=83.0%, Evasion=15.5%
    Learning: Epsilon=0.1340, Memory=10000
    Rewards: Current=0.0, Average=0.00
    Actions so far: 96 move, 14 consume, 90 tax
    Rewards: total=-100.0, deaths=1, punishment=0.0
  [DEBUG Year 1] Pop=199, Gini=0.225, Sugar=2829, Deaths=1
    Rewards: total=-200.0, deaths=2, punishment=0.0
  [DEBUG Year 2] Pop=197, Gini=0.238, Sugar=2899, Deaths=2
    Rewards: total=-200.0, deaths=2, punishment=0.0
    Rewards: total=-400.0, deaths=4, punishment=0.0
    Rewards: total=-500.0, deaths=5, punishment=0.0
    Rewards: total=-500.0, deaths=5, punishment=0.0
    Rewards: total=-500.0, deaths=5, punishment=0.0
    Rewards: total=-500.0, deaths=5, punishment=0.0
  [DEBUG Year 10] Pop=171, Gini=0.324, Sugar=3678, Deaths=5
    Rewards: total=-700.0, deaths=7, punishment=0.0
    Rewards: total=-400.0, deaths=4, punishment=0.0
    Rewards: total=-300.0, deaths=3, punishment=0.0
    Rewards: total=-500.0, deaths=5, punishment=0.0
    Rewards: total=-300.0, deaths=3, punishment=0.0
    Rewards: total=-200.0, deaths=2, punishment=0.0
  [DEBUG Year 20] Pop=147, Gini=0.316, Sugar=5107, Deaths=0
    Rewards: total=-100.0, deaths=1, punishment=0.0
    Rewards: total=-100.0, deaths=1, punishment=0.0
  🏃 Year 25: Regular period - movement and consumption only
    Actions: 123 move, 22 consume, 0 tax (took 0.095s)
    Rewards: total=-100.0, deaths=1, punishment=0.0
    Rewards: total=-100.0, deaths=1, punishment=0.0
    Rewards: total=-300.0, deaths=3, punishment=0.0
  [DEBUG Year 30] Pop=140, Gini=0.324, Sugar=6657, Deaths=0
    Rewards: total=-100.0, deaths=1, punishment=0.0
    Rewards: total=-100.0, deaths=1, punishment=0.0
    Rewards: total=-100.0, deaths=1, punishment=0.0
  [DEBUG Year 49] Pop=137, Gini=0.339, Sugar=9568, Deaths=0
  🔍 Year 50: AUDIT PERIOD - agents making tax decisions
    Actions: 65 move, 5 consume, 67 tax (took 0.121s)
    Rewards: total=-100.0, deaths=1, punishment=0.0
    🧠 Training: memory=10000, epsilon=0.1043, added 0 experiences
  [DEBUG Year 50] Pop=136, Gini=0.352, Sugar=6415, Deaths=1

📊 Year 50 Summary:
    Population: 136 (deaths this year: 1)
    Economics: Gini=0.352, Total Sugar=6415
    Tax Behavior: Compliance=72.1%, Evasion=14.0%
    Learning: Epsilon=0.1043, Memory=10000
    Rewards: Current=-100.0, Average=-125.49
    Actions so far: 6421 move, 1305 consume, 157 tax
  [DEBUG Year 51] Pop=136, Gini=0.354, Sugar=6571, Deaths=0
    Rewards: total=-100.0, deaths=1, punishment=0.0
    Rewards: total=-100.0, deaths=1, punishment=0.0
    Rewards: total=-100.0, deaths=1, punishment=0.0
    Rewards: total=-200.0, deaths=2, punishment=0.0
    Rewards: total=-100.0, deaths=1, punishment=0.0
    Rewards: total=-100.0, deaths=1, punishment=0.0
    Rewards: total=-100.0, deaths=1, punishment=0.0
    Rewards: total=-100.0, deaths=1, punishment=0.0
    Rewards: total=-100.0, deaths=1, punishment=0.0
    Rewards: total=-100.0, deaths=1, punishment=0.0
  🏃 Year 75: Regular period - movement and consumption only
    Actions: 100 move, 25 consume, 0 tax (took 0.114s)
    Rewards: total=-100.0, deaths=1, punishment=0.0
    Rewards: total=-100.0, deaths=1, punishment=0.0
  🔍 Year 100: AUDIT PERIOD - agents making tax decisions
    Actions: 77 move, 14 consume, 32 tax (took 0.098s)
    Rewards: total=0.0, deaths=0, punishment=0.0
    🧠 Training: memory=10000, epsilon=0.0812, added 0 experiences
  [DEBUG Year 100] Pop=123, Gini=0.321, Sugar=8816, Deaths=0

📊 Year 100 Summary:
    Population: 123 (deaths this year: 0)
    Economics: Gini=0.321, Total Sugar=8816
    Tax Behavior: Compliance=74.0%, Evasion=0.8%
    Learning: Epsilon=0.0812, Memory=10000
    Rewards: Current=0.0, Average=-76.24
    Actions so far: 11342 move, 2681 consume, 189 tax
    Rewards: total=-100.0, deaths=1, punishment=0.0
  🏃 Year 125: Regular period - movement and consumption only
    Actions: 30 move, 92 consume, 0 tax (took 0.120s)
    Rewards: total=0.0, deaths=0, punishment=0.0
    Rewards: total=-100.0, deaths=1, punishment=0.0
    Rewards: total=-100.0, deaths=1, punishment=0.0
    Rewards: total=-100.0, deaths=1, punishment=0.0
    Rewards: total=-100.0, deaths=1, punishment=0.0
  🔍 Year 150: AUDIT PERIOD - agents making tax decisions
    Actions: 3 move, 22 consume, 93 tax (took 0.093s)
    Rewards: total=0.0, deaths=0, punishment=0.0
    🧠 Training: memory=10000, epsilon=0.0632, added 0 experiences

📊 Year 150 Summary:
    Population: 118 (deaths this year: 0)
    Economics: Gini=0.331, Total Sugar=10308
    Tax Behavior: Compliance=76.3%, Evasion=0.0%
    Learning: Epsilon=0.0632, Memory=10000
    Rewards: Current=0.0, Average=-54.30
    Actions so far: 14025 move, 5981 consume, 282 tax
    Rewards: total=-200.0, deaths=2, punishment=0.0
  🏃 Year 175: Regular period - movement and consumption only
    Actions: 62 move, 54 consume, 0 tax (took 0.098s)
    Rewards: total=0.0, deaths=0, punishment=0.0
    Rewards: total=-100.0, deaths=1, punishment=0.0
    Rewards: total=-100.0, deaths=1, punishment=0.0

✅ Episode Complete!
    Total years: 200
    📊 Data points collected: 200 (tracking every year)
    Total deaths: 86
    Average reward per year: -43.00
    Final epsilon: 0.049414
    Final memory size: 10000

🎯 Episode 3 COMPLETE! (took 1.1 minutes)
    Final learning state:
      - Epsilon (exploration): 0.049414
      - Memory size: 10,000 experiences
      - Years completed: 200
      - Final population: 114
      - Final Gini coefficient: 0.324
      - Final compliance rate: 78.9%

💾 Saving final models...

============================================================
🏁 EXPERIMENT 'dqn_test_strict' COMPLETE!
============================================================
⏱️  Total time: 3.5 minutes (0.06 hours)
📊 Episodes completed: 600
🧠 Final learning parameters:
    - Epsilon: 0.049414
    - Memory: 10,000 experiences
    - Network updates: 600
📈 Experiment Statistics:
    - Total simulation years: 600
    - Average population: 134.7
    - Average Gini coefficient: 0.329
    - Average compliance rate: 85.6%
    - Total agent deaths: 236
   ✅ Experiment 'dqn_test_strict' complete!

============================================================
ANALYZING DQN RESULTS
----------------------------------------

📊 Analyzing 600 total data points...
   Data spans 0 to 199 years
   Unique years tracked: 200
   Experiments: ['dqn_test_strict']
   Summary contains 200 aggregated data points
   Graphing continuous data from year 0 to 199
✅ Results saved to results/dqn_experiment_summary.csv
📊 Plots saved to results/dqn_summary_plot.png

📈 Final Statistics:
----------------------------------------

dqn_test_strict:
  Final Gini: 0.323
  Final Compliance: 0.875
  Final Population: 121
  Final Evasion Rate: 0.036
  Avg Deaths/Year: 0.0

============================================================
DQN SIMULATION COMPLETE!
============================================================
🧠 Clearing TensorFlow sessions...
✅ TensorFlow cleanup complete
🔌 Closing NetLogo connection...
✅ NetLogo workspace closed
⚡ Skipping JVM shutdown (will force exit)...

🔚 Program terminated successfully
Job done DQN run completed at Thu Oct 16 11:06:16 AM SAST 2025
